\chapter{Implizite Einschrittverfahren}

Steife Systeme treten aber auch in der Modellierung von Reaktionen in der Chemie auf. Als Beispiel soll
eine chemische Reaktion dreier Stoffe $A;B;C$ aus [3] dienen:

\begin{equation*}
	A \rightarrow B, \quad B + B \rightarrow C+ B, \quad B + C \rightarrow A + C
\end{equation*}. 

Die Dynamik der Konzentrationen der einzelnen Komponenten können durch Anfangswertproblem
\begin{align}\label{eq:matrix}
	A:y'_1&= &{}-0.04\cdot y_1  &{}+ 10^4\cdot y_2y_3& & &\\
	B:y'_2&= & 0.04\cdot y_1  &{}- 10^4\cdot y_2y_3& &{}- 3\cdot 10^7y_2^2 &\\
	C:y'_3&= &                  &                  &  & 3\cdot 10^7y_2^2 &\\
\end{align}



%\begin{align*}
%	A: y'_1 = -0.04y_1 + 10^4y_2y_2\\
%	B: y'_2 =  0.04y_1 - 10^4y_2y_3\cdot - 3\cdot 10^7y^2_2
%	C: y'_3 =                              3\cdot 10^7y^2_2
% \end{align*}

mit den Anfangswerten

\begin{equation*}
y_1(0) = 1, y^2_2(0) = 0, y_3(0) = 0
\end{equation*}  

modelliert werden. Anhand dieses Systems sollen im folgenden steife Differenzialgleichungen untersucht
und ein effizientes numerisches Verfahren entwickelt werden.

\section{Entwicklung}

Ein allgemeines System von Anfangswertproblemen für eine Funktion y kann als folgendes geschrieben werden:

$ y' = f(t,y) ,quad t \in [a,b],quad y(a) = y_a $


Der Wert von y wird näherungsweise an den Zeitpunkten berechnet:

$ y^(i) \approx y(t_i),quad i = 0,1,....;N $

Das implizite Euler-Verfahren
$ y^{(i+1)} = y(i) + hf(t_i+1,y^{(i+1)}] $

Die implizite Trapezregel:
$ y^(i+1) = y(i) + h/2[f(t_i, y^(i) + f(t_i+1,y^(i+1)))] $



Aufgabe 1.
Erarbeiten Sie sich Abschnitt 8.4 aus \cite{Atkinson.2004} Atkinson Han Elementary Numerical Analysis 2004 AuszugDatei und fassen Sie in eigenen Worten zusammen, was Sie unter steifen Differenzialgleichung verstehen.
Unter einer starren Differentialgleichung versteht man eine Gleichung mit bestimmten numerischen Methoden, die besonders große Störungsfaktoren am Ausgang aufweisen, sofern die Schrittweite nicht allzu klein ausgewählt wird.



Aufgabe 2:
Setzen Sie in den Gleichungen des impliziten Euler-Verfahrens und der impliziten Trapezregel
$ y^(i+1) = y(i) + z $

und formulieren Sie jeweils die Gleichung für  als Nullstellenproblem:
$ F_euler(z) = 0,quad F_trapez(z) = 0 $

$ y^(i+1) = y(i) + hf(t_i+1,y^(i+1)] $

und die implizite Trapezregel:
$ y^(i+1) = y(i) + h/2[f(t_i, y^(i) + f(t_i+1,y^(i+1)))] $

wir setzen nun
$ y^(i+1) = y^(i) + z $

in:

$ y^(i) + z = y^(i) + hf(t_i+1,y^(i) + z) $

und in:

$ y^(i) + z = y^(i) + h/2 [f(t_i, y^(i) + f(t_i+1,y^(i) + z)] $

ein. Formulieren wir nun beides als Nullstellenproblem für  erhalten wir

$ F_euler(z) = z - hf(t_i+1, y^(i) + z) = 0 $

und 

$F_trapez(z) =  z - h/2 [f(t_i, y^(i) + f(t_i+1,y^(i) + z)] = 0$

Aufgabe 3.
Bestimmen Sie die Jacobi-Matrizen  und  von  und  in Abhängigkeit von , d.h. der Jacobi-Matrix von  bezüglich .

$ D\cdot F_euler(z) = D\cdot z - h\cdot D_(y)\cdot f(t_i+1, y^(i) + z) $

für das implizite Euler-Verfahren und

$ D\cdot F_euler(z) = h/2\cdot [D_(y)\cdot f(t_i+1, y^(i)) +  h\cdot D_(y)f(t_i+1, y^(i) + z)] - D\cdot z $

für das implizite Trapez-Verfahren,

wobei $D, f $=
\begin{equation}
\begin{bmatrix}
	\frac{\partial f_1 }{\partial y_1} & \frac{\partial f_1 }{\partial y_2} & ... & \frac{\partial f_1 }{\partial y_n} \\
	\frac{\partial f_2 }{\partial y_1} & \frac{\partial f_2 }{\partial y_2} & ... & \frac{\partial f_2 }{\partial y_n} \\
	... & ... & ... & ... \\
	\frac{\partial f_n }{\partial y_1} & \frac{\partial f_n }{\partial y_2} & ... & \frac{\partial f_n }{\partial y_n} 
\end{bmatrix} 
\end{equation}


und $Dz$ =
\begin{equation}
\begin{bmatrix}
	1 & 0 & ... & 0 \\
	0 & 1 & ... & 0 \\
	... & ... & ... & ... \\
	0 & ... & 0 & 1 
\end{bmatrix}  
\end{equation}



\section{Anwendung}

1. Formulieren Sie Gleichung (9) als System der Form (11) mit Funktion $fchem(t; y)$.

$y' = f(t,y) = $
\begin{equation}
\begin{bmatrix}
	-0.04y_1 + 10^4y_2y_3 \\
	0.04y_1-10^4y_2y_3-3\cdot 10^7y^2_2 \\
	3 \cdot 10^7y^2_2 
\end{bmatrix}  
\end{equation}


mit $ t\in [0,\sim], y(0) = $ 
\begin{equation}
\begin{bmatrix}
	1 \\
	0 \\
	0
\end{bmatrix}
\end{equation}

2. Implementieren Sie die Funktion als Routine $ d_y = f_chem(t,y) $

Code!

3. Berechnen Sie die Jacobi-Matrix $ D_yf_chem(t,y) $ von $ f_chem $ bezüglich $ y $


$ D_yf_chem(t,y) = $

\begin{equation}
\begin{bmatrix}
	-0.04 & 10^4y_3 & 10^4y_2 \\
	0.04 & -10^4y_3-6\cdot 10^7y_2 & -10^4y_2 \\
	0 & 3\cdot 10^7 & 0 
\end{bmatrix}
\end{equation}

4. Implementieren Sie die Funktion als Routine $ J = f-chem-jac(t,y) $
