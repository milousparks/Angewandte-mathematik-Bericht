\chapter{Finite Differenzen der stationären Gleichung}
Im folgendem Kapitel soll die stationäre Verteilung der Ladungsträger bei kontinuierlicher Bestrahlung modelliert werden. 
Dadurch kann die zeitliche Abhängigkeit vernachlässige werden ($\frac{\partial u}{\partial t}=0$)
 
Die allgemeine DGL ist gegeben durch:
\begin{equation}
	\frac{\partial u}{\partial t}= D\cdot\frac{\partial ^2 u }{\partial z^2}-(k1+k2\cdot N_D)\cdot u -k2u^2 +s(t,z)
\end{equation}

Mit $\frac{\partial u}{\partial t}=0$ folgt die stationäre Gleichung:

\begin{equation}\label{eq:stationDGL}
	D\cdot \frac{du}{dt} -\left( k_1 +k_2 N_D\right)\cdot u-k_2\cdot u^2=-s(z), \quad 0 <z<d
\end{equation}

mit den Randbedingungen:

\begin{equation}
	D\cdot \frac{\partial u}{\partial z}(0)=S_Lu(0),\quad D\frac{\partial u}{\partial z}(d)=-S_Ru(d)
\end{equation}

\section{Lineare stationäre Gleichung}
Im Folgendem Kapitel soll nur der in u lineare Anteil der stationären, zeitunabhängigen Gleichung (Eq. \ref{eq:stationDGL}) ohne den quadratischen Term $-k_2u^2$ behandelt werden\cite{Prof.Dr.AndreasZeiser.April2021}.

1. . Erarbeiten Sie sich Abschnitt 8.8 aus [1] und beschreiben Sie Ihr Vorgehen für die Anwendung der Methode auf Gleichung (6).

Mit der Verwendung dieser Methode auf die Gleichung 6 lässt sich ein Matrix berechnen, womit man die zeitabhängige Stelle der Leitungsträgerdichte u mathematisch beschreiben kann.dadurch kann ein Modell aus der Diskretisierung der Methode erstellt, das die lange dieser Ladungsträgerdichte an einer Zeit beschreibt.

2. Leiten Sie analog zu Gleichung (8.128) die Gleichungen für die gesuchten Werte  u0, u1, . . . , uN an den Punkten z0, . . . , zN her. Die Gleichungen enthalten $u_1 und u_\mathrm{N+1}$, die im nächsten Schritt eliminiert werden. Verwenden Sie dabei die Abkürzung $ si = s(zi)$.


\begin{equation}
	D\cdot \frac{du}{dt} -\left( k_1 +k_2 N_D\right)\cdot u-k_2\cdot u^2=-s(z), \quad 0 <z<d
\end{equation}\label{eq:stationDGL}
\begin{align*}
	k&=k_1+k_2*N_D\\
	s_i&=s(z_i)\\
	u(i)&\approx u_i
\end{align*}

\begin{equation}
	\frac{\partial u}{\partial z} = (u_i+1 - u_i)/(2\cdot h)
\end{equation}

\begin{equation}
	\frac{\partial ^2 u }{\partial z^2} = (u_i+1 - 2\cdot u_i + u_i-1)/(h^2) \quad i=1,2,\dots,N
\end{equation}

\begin{equation}
	D\cdot ((u_i+1 - 2\cdot u_i + u_i-1)/(h^2)) -k\cdot u = -s_i
\end{equation}

\begin{equation}
	(D/h^2)\cdot u_i-1 - (2D/h^2+k)\cdot u_i + (D/h^2)\cdot u_i+1 = -s_i
\end{equation}

3. Approximieren Sie die ersten Ableitungen an den Randbedingungen:

\begin{equation}
	D\cdot \frac{\partial u}{\partial z}(0)=S_Lu(0),\quad D\frac{\partial u}{\partial z}(d)=-S_Ru(d)
\end{equation}
durch:

\begin{equation}
	u' = \frac{u_1-u_-1}{2*h}, \quad u'(d) = \frac{u_N+1-u_N-1}{2*h}
\end{equation}

und lösen Sie die Gleichungen nach $u_1$ bzw. $u_N+1$ auf. Setzen Sie diese Ausdrücke in die Gleichungen für die Knoten $z_0$ und $z_N$ der letzten Teilaufgabe ein.

Erste Randbedingungen:

\begin{equation}
	D\cdot \frac{\partial u}{\partial z}(0)=S_Lu(0)
\end{equation}

\begin{equation}
	\frac{\partial u(0)}{\partial z}=S_Lu(0)/D	
\end{equation}

\begin{equation}
	S_Lu(0)/D = \frac{u_1-u_-1}{2*h}
\end{equation}

\begin{equation}
	u(0) = D\cdot \frac{u_1-u_-1}{2*h}/S_L
\end{equation}

\begin{equation}
	u(0) = \frac{D}{2*h*S_L} * u_1 - \frac{D}{2*h*S_L} * u_-1
\end{equation}

\begin{equation}
	u_-1 = u_1 - \frac{2*h*S_L}{D} * u_(0)
\end{equation}

Zweite Randbedingungen:

\begin{equation}
	D\frac{\partial u}{\partial z}(d)=-S_Ru(d)
\end{equation}

\begin{equation}
	\frac{\partial u}{\partial z}(d)=-S_Ru(d)/D
\end{equation}

\begin{equation}
	-S_Ru(d)/D = \frac{u_N+1-u_N-1}{2*h}
\end{equation}

\begin{equation}
	u(d) = D\cdot \frac{u_N+1-u_N-1}{-2*h*S_R}
\end{equation}

\begin{equation}
	u(d) = \frac{D}{-2*h*S_R} * u_N+1 - \frac{D}{-2*h*S_R} * u_N-1
\end{equation}

\begin{equation}
	u_N-1 = \frac{-2*h*S_R}{D} \cdot u_(d) + u_N-1
\end{equation}

\begin{equation}
	u_N+1 = \frac{-2\cdot h\cdot S_R}{D} \cdot u_(N) + u_N-1
\end{equation}


für $z_0$:

\begin{equation}
	z_0: \frac{u_1-2\cdot h\cdot S_R/D\cdot u_0-2\cdot u_0+u_1}{h^2} \cdot D-k\cdot u_(0) = -s_(0)
\end{equation}


für $z_N$:

\begin{equation}
	z_N: \frac{u_N-1-2\cdot h\cdot S_R/D\cdot u_N-2\cdot u_N+u_N-1}{h^2}\cdot  D-k\cdot u_(N) = -s_(N)
\end{equation}

für $z_0$:
\begin{equation}
	\begin{split}
		\frac{u_1-2\cdot h\cdot S_L/D\cdot u_0-2\cdot u_0+u_1}{h^2} \cdot D-k\cdot u_(0) = -s_(0)\\
		\frac{D\cdot u_1}{h^2}-\frac{2\cdot S_L\cdot u_0}{h}-\frac{-2\cdot u_0}{h}+\frac{D\cdot u_1}{h^2}-k\cdot u_(0) = -s_(0)\\
		2\cdot \frac{D\cdot u_1}{h^2}-\frac{2\cdot S_L\cdot u_0}{h}-\frac{-2\cdot u_0}{h}-k\cdot u_(0) = -s_(0)\\
		2\cdot \frac{D}{h^2}\cdot u_1-(\frac{2\cdot S_L}{h}+\frac{-2}{h}+k)\cdot u_(0) = -s_(0)
	\end{split}
\end{equation}


für $z_i$:

\begin{equation}
	\begin{split}
		D\cdot \frac{u_i-1-2\cdot u_i+u_i+1}{h^2}-k\cdot u_(i) = -s_(i)\\
		\frac{D\cdot u_i-1}{h^2}-\frac{2\cdot D\cdot u_i}{h^2}+\frac{-2\cdot u_0}{h}-k\cdot u_(i) = -s_(i)\\
		\frac{D\cdot u_i-1}{h^2}+\frac{D\cdot u_i+1}{h^2}-(\frac{-2\cdot D}{h}+k)\cdot u_(i) = -s_(i)\\
	\end{split}
\end{equation}




für $z_0$:
\begin{equation}
	\begin{split}
		\frac{u_N-1-2\cdot h\cdot S_R/D\cdot u_N-2\cdot u_N+u_N-1}{h^2} \cdot D-k\cdot u_(N) = -s_(N)\\
		\frac{D\cdot u_N-1}{h^2}-\frac{2\cdot S_R\cdot u_N}{h}-\frac{2\cdot u_N\cdot D}{h}+\frac{D\cdot u_N}{h^2}-k\cdot u_(N) = -s_(N)\\
		2\cdot \frac{D\cdot u_N-1}{h^2}-(\frac{2\cdot}{h^2} + \frac{2\cdot S_R}{h} + k)\cdot u_(N) = -s_(N)\\
	\end{split}
\end{equation}




4. Stellen Sie das lineare Gleichungssystem für die Größen  analog zu Gleichung (8.133) in Atkinson Han Elementary Numerical Analysis 2004 AuszugDatei und folgende dar:
$ A\cdot u = b,\quad u = [u_i],\quad b = [b_i]$
Ordnen Sie die Gleichungen analog zu den Knotenpunkten.

für $ u_1$:
\begin{equation}
	\begin{split}
		\frac{D\cdot u_1-1}{h^2}-(\frac{2\cdot D}{h^2} + k)\cdot u_1  + \frac{D\cdot u_1+1}{h^2} = -s_1\\
		\frac{D\cdot u_0}{h^2}-(\frac{2\cdot D}{h^2} + k)\cdot u_1  + \frac{D\cdot u_2}{h^2} = -s_1\\
	\end{split}
\end{equation}


für $ u_N-1$:

\begin{align*}
	\frac{D\cdot u_-1-1}{h^2}-(\frac{2\cdot D}{h^2} + k)\cdot u_N-1  + \frac{D\cdot u_N-1+1}{h^2} &= -s_N-1\\
	\frac{D\cdot u_N-2}{h^2} - (\frac{2\cdot D}{h^2} + k)\cdot u_N-1  + \frac{D\cdot u_N}{h^2} &
	= -s_N-1
\end{align*}

Mit Hilfe der Matrixform $ A\cdot u = b $ lässt sich dieses Gleichungssystem mit Hilfe von Matlab durch  gelöst werden. Dazu wird die Koeffizientenmatrix

\begin{equation}
	\begin{bmatrix}
		-\frac{(2*S_L}{h + 2} & \frac{2*D}{h^2} & \dots &  \dots &  \dots &  \dots \\
		\frac{D}{h^2} & -\frac{(2*D}{h^2 + k)} & \frac{D}{h^2} &  \dots &  \dots &  \dots \\
	\vdots	&  \ddots &  \ddots &  \ddots &  &  \\
	\vdots	& \ddots & \ddots & \ddots &  &  \\
	\vdots	&  &  & \frac{D}{h^2} & -\frac{(2*D}{h^2 + k))} & \frac{D}{h^2} \\
	\vdots	&  &  &  & \frac{2*D}{h^2} & -\frac{(2}{h^2 + 2*S_R} 
	\end{bmatrix}
\end{equation}
 

der unbekannten Vektor:


und die rechte Seite:


bestimmt.

\section{Nicht Lineare stationäre Gleichung}
Nichtlineare DGL:
\begin{equation}
	D\pdv[order={2}]{u}{z}-(k_1+k_2N_D)u-k_2u^2=-s(z)
\end{equation}

Diskretisierung der DGL:

\begin{equation}
	D\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}-k\cdot u_i-k_2 \cdot u_i^2=z_i
\end{equation}

Mit den Randbedingung:

\begin{equation}
	D\cdot \frac{\partial u}{\partial z}(0)=S_Lu(0),\quad D\frac{\partial u}{\partial z}(d)=-S_Ru(d)
\end{equation}

Und den Approximationen der ersten Ableitung der  Randbedingungen:
\begin{equation}
	u'(0)\approx \frac{u_1-u_{-1}}{2h} \quad u'(d)\approx \frac{u_{N+1}-u_{N-1}}{2h}
\end{equation}
Damit folgt für die Randbedingung:
\begin{equation}
	D\cdot \frac{u_1-u_{-1}}{2h}=S_Lu_0,\quad D\frac{u_{N+1}-u_{N-1}}{2h}=-S_Ru_N
\end{equation}
umgestellt nach $u_{-1}$
\begin{equation}
	u_{-1}=-\frac{S_L 2h}{D}\cdot u_0+u_1
\end{equation}
umgestellt nach $u_{N+1}$
\begin{equation}
	u_{N+1}=-\frac{S_R2h}{D}\cdot u_N+u_{N-1}
\end{equation}



Damit folgt für die Funktion $F(u)=b$:

\begin{align*}
	F_0&= \quad \frac{D}{h^2}u_1-\frac{2D+kh^2}{h^2}u_0+\frac{D}{h^2}\cdot\left( -\frac{S_L 2h}{D}\cdot u_0+u_1\right) -k_2u_0^2\\
	\vdots \\
	F_i&= 	\frac{D}{h^2}u_{i+1}-\frac{2D+kh^2}{h^2}u_i+\frac{D}{h^2}\cdot u_{i-1} -k_2u_i^2\\
	\vdots \\
	F_N &= \frac{D}{h^2}\left( -\frac{S_R2h}{D}\cdot u_N+u_{N-1}\right) -\frac{2D+kh^2}{h^2}u_N+\frac{D}{h^2} u_{N-1}-k_2u^2_N\\
\end{align*}


Vereinfacht zu :

\begin{align*}
	F_0&= \quad 2\cdot \frac{D}{h^2}u_1-\left( \frac{S_L2h+2D+kh^2}{h^2}\right) u_0 -k_2u_0^2\\
	\vdots \\
	F_i&= 	\frac{D}{h^2}u_{i+1}-\frac{2D+kh^2}{h^2}u_i+\frac{D}{h^2}\cdot u_{i-1} -k_2u_i^2\\
	\vdots \\
	F_N &= -\frac{2D+kh^2+S_R2h}{h^2}u_N+2\frac{D}{h^2}u_{N-1}-k_2u^2_N\\
\end{align*}



